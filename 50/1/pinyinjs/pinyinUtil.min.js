(function(n,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(n):t(n)})("undefined"!=typeof window?window:this,function(n){function t(n,t,e){t=t||"";for(var o=[""],r=[],p=0;p<n.length;p++){r=[];for(var f=n[p].split(t),h=0;h<f.length;h++)for(var u=0;u<o.length;u++)r.push(o[u]+(o[u]?e:"")+f[h]);o=r}return i(o)}function e(t,e,i,o){var r=n.pinyin_dict_polyphone,f=7,h=r[t];if(h){h=h.split(" ");for(var u=0;u<h.length;u++)e[u]=h[u]||e[u],o||(e[u]=p.removeTone(e[u]));return e.join(i)}for(u=0;u<t.length;u++){h="";for(var l=0;l<f&&u+l<t.length&&/^[\u2E80-\u9FFF]+$/.test(t[u+l]);l++){h+=t[u+l];var a=r[h];if(a){a=a.split(" ");for(var c=0;c<=l;c++)a[c]&&(e[u+c]=o?a[c]:p.removeTone(a[c]));break}}}for(u=0;u<e.length;u++)e[u]=e[u].replace(/ .*$/g,"");return e.join(i)}function i(n){for(var t=[],e={},i=0;i<n.length;i++){var o=typeof n[i]+n[i];e[o]||(t.push(n[i]),e[o]=!0)}return t}var o={"ā":"a1","á":"a2","ǎ":"a3","à":"a4","ō":"o1","ó":"o2","ǒ":"o3","ò":"o4","ē":"e1","é":"e2","ě":"e3","è":"e4","ī":"i1","í":"i2","ǐ":"i3","ì":"i4","ū":"u1","ú":"u2","ǔ":"u3","ù":"u4","ü":"v0","ǖ":"v1","ǘ":"v2","ǚ":"v3","ǜ":"v4","ń":"n2","ň":"n3","":"m2"},r={},p={parseDict:function(){if(n.pinyin_dict_firstletter&&(r.firstletter=pinyin_dict_firstletter),n.pinyin_dict_notone)for(var t in r.notone={},r.py2hz=pinyin_dict_notone,pinyin_dict_notone)for(var e=pinyin_dict_notone[t],i=0,o=e.length;i<o;i++)r.notone[e[i]]||(r.notone[e[i]]=t);if(n.pinyin_dict_withtone){r.withtone={};for(e=pinyin_dict_withtone.split(","),t=0,o=e.length;t<o;t++)r.withtone[String.fromCharCode(t+19968)]=e[t];if(n.pinyin_dict_notone)r.py2hz=pinyin_dict_notone;else{var f,h,u=p.removeTone(pinyin_dict_withtone).split(","),l={};for(t=0,o=u.length;t<o;t++){h=String.fromCharCode(t+19968),f=u[t].split(" ");for(i=0;i<f.length;i++)l[f[i]]=(l[f[i]]||"")+h}r.py2hz=l}}},getPinyin:function(i,o,p,f){if(!i||/^ +$/g.test(i))return"";o=null==o?" ":o,p=null==p||p,f=null!=f&&f;var h=[];if(r.withtone){for(var u="",l=0,a=i.length;l<a;l++){var c=r.withtone[i[l]];c?(f||(c=c.replace(/ .*$/g,"")),p||(c=this.removeTone(c)),u&&(h.push(u),u=""),h.push(c)):!i[l]||/^ +$/g.test(i[l])?u&&(h.push(u),u=""):u+=i[l]}u&&(h.push(u),u="")}else{if(!r.notone)throw"抱歉，未找到合适的拼音字典文件！";p&&console.warn("pinyin_dict_notone 字典文件不支持声调！"),f&&console.warn("pinyin_dict_notone 字典文件不支持多音字！");for(u="",l=0,a=i.length;l<a;l++){var s=i.charAt(l);c=r.notone[s];c?(u&&(h.push(u),u=""),h.push(c)):!s||/^ +$/g.test(s)?u&&(h.push(u),u=""):u+=s}u&&(h.push(u),u="")}return f?n.pinyin_dict_polyphone?e(i,h,o,p):t(h," ",o):h.join(o)},getFirstLetter:function(n,e){if(e=null!=e&&e,!n||/^ +$/g.test(n))return"";if(r.firstletter){for(var o=[],p=0;p<n.length;p++){var f=n.charCodeAt(p),h=n.charAt(p);f>=19968&&f<=40869&&(h=r.firstletter.all.charAt(f-19968),e&&(h=r.firstletter.polyphone[f]||h)),o.push(h)}return e?t(o,"",""):o.join("")}var u=this.getPinyin(n," ",!1,e);u=u instanceof Array?u:[u];for(o=[],p=0;p<u.length;p++)o.push(u[p].replace(/(^| )(\w)\w*/g,function(n,t,e){return e.toUpperCase()}));return e?i(o):o[0]},getHanzi:function(n){if(!r.py2hz)throw"抱歉，未找到合适的拼音字典文件！";return r.py2hz[this.removeTone(n)]||""},getSameVoiceWord:function(n,t){return t=t||!1,this.getHanzi(this.getPinyin(n," ",!1))},removeTone:function(n){return n.replace(/[āáǎàōóǒòēéěèīíǐìūúǔùüǖǘǚǜńň]/g,function(n){return o[n][0]})},getTone:function(n){var t={};for(var e in o)t[o[e]]=e;return(n||"").replace(/[a-z]\d/g,function(n){return t[n]||n})}};p.parseDict(),p.dict=r,n.pinyinUtil=p});